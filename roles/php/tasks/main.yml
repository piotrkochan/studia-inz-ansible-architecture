---

- name: Load php vars
  include_vars: "vars/php-{{ php__version }}.yml"

- name: Install repositories
  include_role:
    name: yum
  vars:
    yum__packages: "{{ php__yum_reposources }}"

- name: Install packages and repositories
  include_role:
    name: yum
  vars:
    yum__packages: "{{ php__yum_packages }}"
    yum__enablerepo: "{{ php__yum__enablerepo }}"
    yum__disablerepo: "{{ php__yum_disablerepo }}"

# - name: Install dnf-plugins
#   package:
#     name: dnf-plugins-core
#     state: present

# - name: Enable DNF module for CentOS 8+.
#   shell: |
#     dnf config-manager --set-enabled powertools
#     dnf module enable -y php:remi-{{ php_version }}
#   register: dnf_module_enable
#   changed_when: "'Nothing to do' not in dnf_module_enable.stdout"
